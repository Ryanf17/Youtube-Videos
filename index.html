<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ryan's Builds</title>
<style>
  body {
    margin: 0;
    padding: 0;
    font-family: sans-serif;
    background-color: #111;
    color: white;
    min-height: 100vh;
    text-align: center;
  }
  h1 {
    font-size: 3rem;
    margin-bottom: 10px;
    padding-top: 50px;
  }
  p {
    max-width: 600px;
    margin: 20px auto;
    font-size: 1.2rem;
    line-height: 1.5;
  }
  .button-group {
    margin: 20px auto 40px;
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    justify-content: center;
    max-width: 800px;
    cursor: grab;
  }
  .button-group a {
    user-select: none;
    text-decoration: none;
    color: white;
    background-color: #444;
    padding: 10px 20px;
    border-radius: 8px;
    font-size: 1rem;
    transition: background 0.3s;
    display: inline-flex;
    align-items: center;
  }
  .button-group a:hover {
    background-color: #666;
  }
  .button-group a.donate {
    background-color: #28a745;
    font-weight: bold;
  }
  .button-group a.donate:hover {
    background-color: #218838;
  }
  .gear-container {
    position: fixed;
    top: 15px;
    right: 15px;
    cursor: pointer;
    color: white;
    font-size: 28px;
    user-select: none;
    z-index: 1100;
  }
  /* Admin Mode banner */
  #adminBanner {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background-color: #28a745;
    color: white;
    font-weight: 700;
    padding: 10px 0;
    font-size: 1.1rem;
    z-index: 1200;
    display: none;
  }
  /* Admin sidebar */
  #adminSidebar {
    position: fixed;
    top: 50px;
    right: 0;
    width: 260px;
    height: calc(100% - 50px);
    background: #222;
    border-left: 1px solid #444;
    padding: 15px;
    box-sizing: border-box;
    color: white;
    font-size: 14px;
    display: none;
    z-index: 1100;
  }
  #adminSidebar h3 {
    margin-top: 0;
    margin-bottom: 15px;
  }
  #adminSidebar button {
    width: 100%;
    margin-bottom: 10px;
    padding: 10px;
    background: #444;
    border: none;
    border-radius: 5px;
    color: white;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.3s;
  }
  #adminSidebar button:hover {
    background: #666;
  }
  #adminSidebar label {
    display: block;
    margin-top: 10px;
    text-align: left;
  }
  #adminSidebar input[type="text"],
  #adminSidebar input[type="url"] {
    width: 100%;
    padding: 6px;
    margin-top: 5px;
    border-radius: 5px;
    border: none;
    font-size: 14px;
  }
  #adminSidebar small {
    font-size: 12px;
    color: #bbb;
  }
  /* Login form styles */
  #loginForm {
    display: flex;
    flex-direction: column;
  }
  #loginForm label {
    margin: 8px 0 4px;
    text-align: left;
  }
  #loginForm input {
    padding: 8px;
    border-radius: 5px;
    border: none;
    font-size: 14px;
    margin-bottom: 12px;
  }
  #loginForm button {
    background: #28a745;
    color: white;
    border: none;
    border-radius: 5px;
    padding: 10px;
    cursor: pointer;
    font-weight: 700;
    font-size: 14px;
    transition: background 0.3s;
  }
  #loginForm button:hover {
    background: #218838;
  }
  /* Draggable placeholder style */
  .dragging {
    opacity: 0.5;
  }
</style>
</head>
<body>

  <div id="adminBanner">Admin Mode Active</div>

  <div class="gear-container" id="gearBtn" title="Settings ⚙️">&#9881;</div>

  <div id="adminSidebar">
    <h3>Admin Panel</h3>

    <button id="logoutBtn">Logout</button>

    <hr />

    <h4>Add New Button</h4>
    <label for="newBtnText">Button Text:</label>
    <input type="text" id="newBtnText" placeholder="Button 5" />
    <label for="newBtnUrl">Button URL:</label>
    <input type="url" id="newBtnUrl" placeholder="https://example.com" />
    <label><input type="checkbox" id="newBtnDonate" /> Is Donate Button (green)</label>
    <button id="addBtn">Add Button</button>

    <hr />

    <p><small>Drag and drop buttons above to rearrange them.</small></p>
  </div>

  <h1>Ryan's Builds</h1>
  <p>
    Welcome to Ryan's Builds — a personal showcase of my custom creations in Rocitizens. It's a fun way to share tours, builds, and design ideas with the community. Feel free to explore and get inspired!
  </p>

  <div class="button-group" id="buttonGroup" draggable="false">
    <a href="index.html">Home</a>
    <a href="tour.html">CPS Build Tour</a>
    <a href="#">Button 2</a>
    <a href="#">Button 3</a>
    <a href="#">Button 4</a>
    <a href="https://plsdonate.me/ryfo_17" class="donate" target="_blank" rel="noopener noreferrer">Donate</a>
  </div>

<script>
  // Credentials
  const ADMIN_USERNAME = 'Ryanf17';
  const ADMIN_PASSWORD = 'G7m#P9xL2@Qz';

  const gearBtn = document.getElementById('gearBtn');
  const adminSidebar = document.getElementById('adminSidebar');
  const adminBanner = document.getElementById('adminBanner');
  const buttonGroup = document.getElementById('buttonGroup');
  const logoutBtn = document.getElementById('logoutBtn');
  const addBtn = document.getElementById('addBtn');
  const newBtnText = document.getElementById('newBtnText');
  const newBtnUrl = document.getElementById('newBtnUrl');
  const newBtnDonate = document.getElementById('newBtnDonate');

  // State
  let dragSrcEl = null;

  // Show admin UI if logged in
  function showAdminUI() {
    adminSidebar.style.display = 'block';
    adminBanner.style.display = 'block';
  }
  // Hide admin UI
  function hideAdminUI() {
    adminSidebar.style.display = 'none';
    adminBanner.style.display = 'none';
  }

  // Check login status
  function checkLogin() {
    return sessionStorage.getItem('loggedIn') === 'true';
  }

  // Login prompt function
  async function promptLogin() {
    const username = prompt('Enter admin username:');
    if (username === null) return false; // Cancel

    const password = prompt('Enter admin password:');
    if (password === null) return false; // Cancel

    if (username === ADMIN_USERNAME && password === ADMIN_PASSWORD) {
      sessionStorage.setItem('loggedIn', 'true');
      alert('Login successful!');
      showAdminUI();
      return true;
    } else {
      alert('Incorrect username or password.');
      return false;
    }
  }

  // Gear icon click - toggle admin or login prompt
  gearBtn.addEventListener('click', async () => {
    if (checkLogin()) {
      // Toggle sidebar
      adminSidebar.style.display = adminSidebar.style.display === 'block' ? 'none' : 'block';
      adminBanner.style.display = adminSidebar.style.display === 'block' ? 'block' : 'none';
    } else {
      await promptLogin();
    }
  });

  // Logout
  logoutBtn.addEventListener('click', () => {
    sessionStorage.removeItem('loggedIn');
    hideAdminUI();
    alert('Logged out.');
  });

  // Drag & Drop handlers
  function handleDragStart(e) {
    if (!checkLogin()) return; // only allow dragging if logged in

    dragSrcEl = this;
    e.dataTransfer.effectAllowed = 'move';
    e.dataTransfer.setData('text/html', this.outerHTML);

    this.classList.add('dragging');
  }
  function handleDragOver(e) {
    if (!checkLogin()) return;
    if (e.preventDefault) e.preventDefault();
    e.dataTransfer.dropEffect = 'move';
    return false;
  }
  function handleDragEnter(e) {
    if (!checkLogin()) return;
    this.classList.add('over');
  }
  function handleDragLeave(e) {
    if (!checkLogin()) return;
    this.classList.remove('over');
  }
  function handleDrop(e) {
    if (!checkLogin()) return;
    if (e.stopPropagation) e.stopPropagation();

    if (dragSrcEl !== this) {
      // Remove old dragged element
      dragSrcEl.parentNode.removeChild(dragSrcEl);

      // Insert dragged element before the drop target
      const dropHTML = e.dataTransfer.getData('text/html');
      this.insertAdjacentHTML('beforebegin', dropHTML);

      // Add drag handlers to new element
      const droppedElem = this.previousSibling;
      addDnDHandlers(droppedElem);
    }
    return false;
  }
  function handleDragEnd(e) {
    if (!checkLogin()) return;
    this.classList.remove('dragging');

    [...buttonGroup.children].forEach((btn) => {
      btn.classList.remove('over');
    });
  }

  // Attach drag handlers to all buttons
  function addDnDHandlers(elem) {
    elem.setAttribute('draggable', true);
    elem.addEventListener('dragstart', handleDragStart, false);
    elem.addEventListener('dragenter', handleDragEnter, false);
    elem.addEventListener('dragover', handleDragOver, false);
    elem.addEventListener('dragleave', handleDragLeave, false);
    elem.addEventListener('drop', handleDrop, false);
    elem.addEventListener('dragend', handleDragEnd, false);
  }

  // Initialize drag and drop on existing buttons
  [...buttonGroup.children].forEach(addDnDHandlers);

  // Add new button from admin panel
  addBtn.addEventListener('click', () => {
    const text = newBtnText.value.trim();
    const url = newBtnUrl.value.trim();

    if (!text || !url) {
      alert('Please enter both button text and URL.');
      return;
    }

    const a = document.createElement('a');
    a.href = url;
    a.textContent = text;
    a.target = '_blank';
    a.rel = 'noopener noreferrer';
    if (newBtnDonate.checked) {
      a.classList.add('donate');
    }
    buttonGroup.appendChild(a);
    addDnDHandlers(a);

    // Clear inputs
    newBtnText.value = '';
    newBtnUrl.value = '';
    newBtnDonate.checked = false;
  });

  // On page load, show admin if logged in
  if (checkLogin()) {
    showAdminUI();
  }
</script>

</body>
</html>
